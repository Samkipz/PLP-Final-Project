{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% load thumbnail %}
{% load ratings %}

{% block content %}

    <div class="container rental-details-container">
        <div class="row d-flex justify-content-center" style="border-bottom: 1px solid #17a2b8;">
            <div class="col d-flex justify-content-center">
                <h3 class="title-text"> {{ rental.name }} </h3>
            </div>
        </div>
        <div class="row corousel-row mt-2 px-1">
            <div class="col-lg-8 corousel-col px-0">
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                      <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                      <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                      <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img class="d-block w-100" src="{{ rental.img.url }}" alt="First slide">
                          </div>
                        {% for image in rental_images %}
                            <div class="carousel-item">
                                <img class="d-block w-100" src="{{ image.imgs.url }}" alt="First slide">
                            </div>
                        {% endfor %}
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
            <div class="col d-none d-lg-flex flex-column col-lg-4">
                <div class="card mb-3" style="width: 18rem;">
                    <div class="card-body">
                      <h5 class="card-title text-info">Landlord details </h5>
                      <p class="card-text">With supporting content.</p>
                      <a href="#" class="btn btn-primary">Go somewhere</a>
                    </div>
                </div>
                <div class="card" style="width: 18rem;">
                    <div class="card-body">
                      <h5 class="card-title">Special title treatment</h5>
                      <p class="card-text">With supporting text below as n to additional content.</p>
                      <a href="#" class="btn btn-primary">Go somewhere</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row description-row my-3 my-md-4">
            <div class="col-12 d-flex justify-content-center">
                <h2 class="title-text">More About {{ rental.name }} </h2>
            </div>
        </div>
        <div class="row description-row2">
            <ul class="nav nav-tabs" style="width: 100%;">
                <li class="nav-item">
                  <a class="nav-link active" href="#">Description</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#tenants-feedback"> Tenants Review</a>
                </li>
            </ul>
        </div>
        <div class="row">
            <div class="card">
                <div class="card-body">
                  <p class="card-text">{{ rental.content|safe }}</p>
                </div>
            </div>
        </div>
        <div class="row mt-4"> 
            <div class="card" id="tenants-feedback">
                <div class="card-header"> Tenants Feedback </div>
                <div class="card-body">

                    {% for feedback in feedback %}
                        <p class="card-text"> {{ feedback.user }}</p>
                        <p class="card-text">
                            <!-- We need to loop to five values -->
                                {% for i in '12345'|make_list %} 
                                <!-- in every loop check if value is <= to rental_avg_score and, add property:checked -->
                                    {% if i|floatformat:"0" <=  feedback.score|floatformat:"0" %}
                                        <span class="fa fa-star checked"></span>
                                    {% else %}
                                        <span class="fa fa-star"></span>
                                    {% endif %}
                                {% endfor %}
                        </p>
                        <p class="card-text"> {{ feedback.user_msg }}</p> 
                        <p class="card-text"> {{ feedback.feedback_date }} </p>
                        <hr>
                    {% endfor %}

                    <div>
                        <h3>Add feedback</h3>
                        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
                        <form class="rate-form" action="{% url 'allRentals:rental_details' rental.id %}" method="POST" id="{{ rental.id }}">
                            {% csrf_token %}
                            <p class="card-text"> User: <i>{{ request.user }}</i> </p>
                            <p class="card-text">
                                <span class="mybtn fa fa-star" id="first">  </span>
                                <span class="mybtn fa fa-star" id="second"> </span>
                                <span class="mybtn fa fa-star" id="third">  </span>
                                <span class="mybtn fa fa-star" id="fourth"> </span>
                                <span class="mybtn fa fa-star" id="fifth">  </span>
                            </p>
                            <p class="card-text">
                                <textarea class="form-control" aria-label="With textarea" id="msg"></textarea>
                            </p>
                            <input type="submit" class="btn btn-info" value="Post">
                        </form>
                        <hr> 
                    </div>

                  
                </div>
            </div>
        </div>
        
    </div>

{% endblock %}